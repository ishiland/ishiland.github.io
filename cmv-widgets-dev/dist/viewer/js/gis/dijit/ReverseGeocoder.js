/*  ConfigurableMapViewerCMV
 *  version 2.0.0-beta.2
 *  Project: https://cmv.io/
 */

define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/lang","dojo/on","dojo/_base/array","dijit/MenuItem","esri/tasks/locator","esri/graphic","esri/symbols/PictureMarkerSymbol","esri/InfoTemplate","esri/layers/GraphicsLayer","dojo/i18n!./ReverseGeocoder/nls/resource"],function(t,e,s,a,i,o,r,l,n,h,d,c){return t([e],{i18n:c,url:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",distance:1e3,title:"Address At Location",reverseGeocodeTemplate:['<table class="attrTable">','<tr valign="top">','<td class="attrName">${i18n.labels.address}</td>','<td class="attrValue">${Address}</td>',"</tr>",'<tr valign="top">','<td class="attrName">${i18n.labels.neighborhood}</td>','<td class="attrValue">${Neighborhood}</td>',"</tr>",'<tr valign="top">','<td class="attrName">${i18n.labels.city}</td>','<td class="attrValue">${City}</td>',"</tr>",'<tr valign="top">','<td class="attrName">${i18n.labels.subregion}</td>','<td class="attrValue">${Subregion}</td>',"</tr>",'<tr valign="top">','<td class="attrName">${i18n.labels.region}</td>','<td class="attrValue">${Region}</td>',"</tr>",'<tr valign="top">','<td class="attrName">${i18n.labels.postalCode}</td>','<td class="attrValue">${Postal}&nbsp;${PostalExt}</td>',"</tr>",'<tr valign="top">','<td class="attrName">${i18n.labels.countryCode}</td>','<td class="attrValue">${CountryCode}</td>',"</tr>","</table>"].join(""),symbol:new n({angle:20,xoffset:6,yoffset:9,type:"esriPMS",url:"https://static.arcgis.com/images/Symbols/Basic/RedFlag.png",contentType:"image/png",width:18,height:18}),postCreate:function(){this.inherited(arguments),this.locator=new r(this.url),i.forEach(Object.keys(this.i18n.labels),s.hitch(this,function(t){this.reverseGeocodeTemplate=this.reverseGeocodeTemplate.replace("${i18n.labels."+t+"}",this.i18n.labels[t])})),this.map.on("MouseDown",s.hitch(this,function(t){this.mapRightClickPoint=t.mapPoint})),this.mapRightClickMenu.addChild(new o({label:this.i18n.labels.getAddressHere,onClick:s.hitch(this,"reverseGeocode")})),this.infoTemplate=new h(this.title,this.reverseGeocodeTemplate),this.graphics=new d({id:"reverseGeocodeGraphics"}),this.map.addLayer(this.graphics)},reverseGeocode:function(){this.locator.locationToAddress(this.mapRightClickPoint,this.distance,s.hitch(this,"reverseGeocodeComplete"))},reverseGeocodeComplete:function(t){var e=new l(t.location,this.symbol,t.address,this.infoTemplate);this.graphics.clear(),this.graphics.add(e),this.highlight=this.map.infoWindow.get("highlight"),this.map.infoWindow.clearFeatures(),this.map.infoWindow.setTitle(this.title),this.map.infoWindow.setContent(e.getContent()),this.map.infoWindow.setFeatures([e]),this.map.infoWindow.set("highlight",!1);var i=this.map.toScreen(t.location);this.map.infoWindow.show(i,this.map.getInfoWindowAnchor(i)),a.once(this.map.infoWindow,"hide",s.hitch(this,function(){this.graphics.clear(),this.map.infoWindow.clearFeatures(),this.map.infoWindow.set("highlight",this.highlight)}))}})});
//# sourceMappingURL=ReverseGeocoder.js.map