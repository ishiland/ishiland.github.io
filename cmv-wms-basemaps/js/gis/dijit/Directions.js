/*  ConfigurableMapViewerCMV
 *  version 2.0.0-beta.2
 *  Project: https://cmv.io/
 */

define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","esri/dijit/Directions","dojo/text!./Directions/templates/Directions.html","dojo/_base/lang","dijit/Menu","dijit/MenuItem","dijit/PopupMenuItem","dijit/MenuSeparator","esri/geometry/Point","esri/SpatialReference","dojo/topic","dojo/i18n!./Directions/nls/resource","dojo/dom-style"],function(i,t,e,o,n,s,h,d,a,c,r,l,u,p,g){return i([t,e],{templateString:n,i18n:p,postCreate:function(){this.inherited(arguments),this.directions=new o(s.mixin({map:this.map},this.options),this.directionsNode),this.directions.startup(),this.directions._activateButton?g.set(this.directions._activateButton,"display","none"):this.directions._activateButtonNode&&(g.set(this.directions._activateButtonNode,"display","none"),g.set(this.directions._addDestinationNode,"float","inherit"),g.set(this.directions._optionsButtonNode,{float:"inherit",marginRight:"5px"})),this.mapRightClickMenu&&this.addRightClickMenu()},addRightClickMenu:function(){this.map.on("MouseDown",s.hitch(this,function(i){this.mapRightClickPoint=i.mapPoint})),this.menu=new h,this.menu.addChild(new d({label:this.i18n.labels.directionsFromHere,onClick:s.hitch(this,"directionsFrom")})),this.menu.addChild(new d({label:this.i18n.labels.directionsToHere,onClick:s.hitch(this,"directionsTo")})),this.menu.addChild(new c),this.menu.addChild(new d({label:this.i18n.labels.addStop,onClick:s.hitch(this,"addStop")})),this.menu.addChild(new c),this.menu.addChild(new d({label:this.i18n.labels.useMyLocationAsStart,onClick:s.hitch(this,"getGeoLocation","directionsFrom")})),this.menu.addChild(new d({label:this.i18n.labels.useMyLocationAsEnd,onClick:s.hitch(this,"getGeoLocation","directionsTo")})),this.mapRightClickMenu.addChild(new a({label:this.i18n.labels.directions,popup:this.menu}))},clearStops:function(){this.directions.reset()},directionsFrom:function(){this.directions.updateStop(this.mapRightClickPoint,0).then(s.hitch(this,"doRoute"))},directionsTo:function(){this.directions.updateStop(this.mapRightClickPoint,this.directions.stops.length-1).then(s.hitch(this,"doRoute"))},addStop:function(){this.directions.addStop(this.mapRightClickPoint,this.directions.stops.length-1).then(s.hitch(this,"doRoute"))},doRoute:function(){this.parentWidget&&!this.parentWidget.open&&this.parentWidget.toggle(),this.directions.stops[0]&&this.directions.stops[1]&&this.directions.getDirections()},startAtMyLocation:function(){this.getGeoLocation("directionsFrom")},endAtMyLocation:function(){this.getGeoLocation("directionsTo")},getGeoLocation:function(i){navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(s.hitch(this,"locationSuccess",i),s.hitch(this,"locationError")):u.publish("growler/growl",{title:this.i18n.errors.geoLocation.title,message:this.i18n.errors.geoLocation.message,level:"default",timeout:1e4,opacity:1})},locationSuccess:function(i,t){this.mapRightClickPoint=new r(t.coords.longitude,t.coords.latitude,new l({wkid:4326})),this[i]()},locationError:function(i){u.publish("growler/growl",{title:this.i18n.errors.location.title,message:this.i18n.errors.location.message+i.message,level:"default",timeout:1e4,opacity:1})}})});
//# sourceMappingURL=Directions.js.map