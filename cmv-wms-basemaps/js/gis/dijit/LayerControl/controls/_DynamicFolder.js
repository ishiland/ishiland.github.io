/*  ConfigurableMapViewerCMV
 *  version 2.0.0-beta.2
 *  Project: https://cmv.io/
 */

define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom-class","dojo/dom-style","dojo/dom-attr","dojo/fx","dojo/html","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/Folder.html"],function(e,o,t,n,i,a,s,l,c,d,r,h){return e([d,r],{control:null,sublayerInfo:null,icons:null,templateString:h,_expandClickHandler:null,_handlers:[],postCreate:function(){if(this.inherited(arguments),this.control.controlOptions.subLayerInfos&&!this.control.controlOptions.includeUnspecifiedLayers){var e=t.map(this.control.controlOptions.subLayerInfos,function(e){return e.id});t.indexOf(e,this.sublayerInfo.id)<0&&i.add(this.domNode,"layerControlHidden")}this.control.controlOptions.layerIds&&t.indexOf(this.control.controlOptions.layerIds,this.sublayerInfo.id)<0&&i.add(this.domNode,"layerControlHidden");var a=this.checkNode;s.set(a,"data-sublayer-id",this.sublayerInfo.id),i.add(a,this.control.layer.id+"-layerControlSublayerCheck"),-1!==t.indexOf(this.control.layer.visibleLayers,this.sublayerInfo.id)?this._setSublayerCheckbox(!0,a):this._setSublayerCheckbox(!1,a),this._handlers.push(n(a,"click",o.hitch(this,function(e){e.stopPropagation&&e.stopPropagation(),"checked"===s.get(a,"data-checked")?this._setSublayerCheckbox(!1,a):this._setSublayerCheckbox(!0,a),this.control._setVisibleLayers(),this._checkboxScaleRange()}))),c.set(this.labelNode,this.sublayerInfo.name),this._expandClick(),0===this.sublayerInfo.minScale&&0===this.sublayerInfo.maxScale||(this._checkboxScaleRange(),this._handlers.push(this.control.layer.getMap().on("zoom-end",o.hitch(this,"_checkboxScaleRange"))))},_expandClick:function(){var e=this.icons;this._handlers.push(this._expandClickHandler=n(this.expandClickNode,"click",o.hitch(this,function(){var o=this.expandNode,t=this.expandIconNode;"none"===a.get(o,"display")?(l.wipeIn({node:o,duration:300}).play(),i.replace(t,e.folderOpen,e.folder)):(l.wipeOut({node:o,duration:300}).play(),i.replace(t,e.folder,e.folderOpen))})))},_setSublayerCheckbox:function(e,o){o=o||this.checkNode;var t=this.icons;e?(s.set(o,"data-checked","checked"),i.replace(o,t.checked,t.unchecked)):(s.set(o,"data-checked","unchecked"),i.replace(o,t.unchecked,t.checked))},_checkboxScaleRange:function(){var e=this.checkNode,o=this.control.layer.getMap().getScale(),t=this.sublayerInfo.minScale,n=this.sublayerInfo.maxScale;i.remove(e,"layerControlCheckIconOutScale"),(0!==t&&o>t||0!==n&&o<n)&&i.add(e,"layerControlCheckIconOutScale")},destroy:function(){this.inherited(arguments),this._handlers.forEach(function(e){e.remove()})}})});
//# sourceMappingURL=_DynamicFolder.js.map